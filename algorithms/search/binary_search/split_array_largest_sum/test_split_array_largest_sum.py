import unittest
from typing import List
from parameterized import parameterized
from algorithms.search.binary_search.split_array_largest_sum import (
    split_array,
    split_array_2,
)

SPLIT_ARRAY_LARGEST_SUM_TEST_CASES = [
    ([1, 2, 3, 4, 5], 3, 6),
    ([1, 2, 3, 4, 5], 2, 9),
    ([5, 8, 2, 8, 3, 1], 1, 27),
    ([1, 2, 3, 4, 5], 3, 6),
    ([5, 8, 2, 8, 3, 1], 1, 27),
    ([3, 4, 5, 4, 2], 4, 6),
    ([3, 4, 3, 4, 5, 5, 8, 2], 4, 10),
    ([7, 2, 5, 10, 8], 2, 18),
    ([5, 2, 4], 2, 6),
    ([1, 6, 2, 6, 8], 8, 8),
    (
        [
            205,
            7338,
            2958,
            1115,
            199,
            9189,
            8789,
            836,
            945,
            4477,
            2965,
            9855,
            8899,
            9020,
            8429,
            9396,
            8921,
            8866,
            2273,
            4671,
            8633,
            8133,
            2905,
            7687,
            4948,
            1614,
            6723,
            7300,
            4358,
            6217,
            9148,
            2805,
            8703,
            4542,
            2283,
            5241,
            1026,
            6524,
            3682,
            4138,
            7397,
            7726,
            7390,
            2829,
            5742,
            4467,
            3431,
            8410,
            300,
            8935,
            2631,
            4531,
            3189,
            8106,
            346,
            9486,
            9441,
            7647,
            8103,
            8876,
            5810,
            9231,
            232,
            7509,
            5396,
            6839,
            7161,
            2011,
            1309,
            2650,
            5933,
            351,
            4994,
            6355,
            3233,
            1045,
            5034,
            290,
            5300,
            7426,
            2514,
            2911,
            1681,
            3514,
            6794,
            1355,
            5325,
            6754,
            6330,
            3603,
            3094,
            3619,
            7707,
            9516,
            8377,
            9832,
            303,
            4143,
            3180,
            8058,
            7426,
            7475,
            2891,
            7597,
            9302,
            5036,
            1277,
            4340,
            5600,
            9170,
            9342,
            7342,
            9840,
            6184,
            5911,
            4335,
            5623,
            9001,
            3717,
            1247,
            4273,
            685,
            854,
            3363,
            3357,
            6986,
            6845,
            4412,
            1424,
            7086,
            3994,
            9699,
            5657,
            7992,
            9862,
            677,
            1345,
            1722,
            6942,
            6899,
            3741,
            9740,
            2943,
            663,
            5230,
            2885,
            1833,
            7635,
            5586,
            9840,
            2271,
            4508,
            6811,
            3070,
            1749,
            7711,
            4283,
            8633,
            473,
            6349,
            346,
            1605,
            4937,
            1943,
            3874,
            9300,
            592,
            2155,
            7704,
            3773,
            5617,
            9818,
            2175,
            7494,
            4729,
            6114,
            4832,
            4959,
            8260,
            8992,
            8341,
            8237,
            1123,
            6614,
            1060,
            8078,
            6432,
            9313,
            4984,
            2766,
            1562,
            3812,
            6061,
            9870,
            5401,
            235,
            4586,
            7867,
            6289,
            8799,
            5655,
            4072,
            5099,
            6807,
            958,
            5044,
            3805,
            2739,
            6156,
            5344,
            3048,
            6570,
            478,
            4007,
            3761,
            9926,
            6599,
            7156,
            6746,
            1362,
            3258,
            4989,
            5490,
            2394,
            4901,
            8658,
            868,
            6577,
            9274,
            8265,
            1457,
            1617,
            3361,
            508,
            8641,
            2481,
            1313,
            2510,
            3263,
            9630,
            6079,
            6813,
            4104,
            7269,
            4541,
            7588,
            4909,
            6186,
            2548,
            344,
            1880,
            5221,
            4452,
            3237,
            2396,
            7917,
            7004,
            8875,
            9453,
            2542,
            482,
            5828,
            9493,
            8023,
            5020,
            691,
            5206,
            348,
            3037,
            8988,
            5174,
            1364,
            2024,
            7646,
            6565,
            4156,
            4044,
            3793,
            172,
            1696,
            5781,
            1373,
            2128,
            9421,
            858,
            7822,
            3599,
            3966,
            6816,
            5115,
            8702,
            2885,
            8298,
            7366,
            1942,
            6369,
            7229,
            4717,
            3011,
            8435,
            253,
            9452,
            7163,
            7173,
            2558,
            5439,
            2732,
            1568,
            9809,
            1427,
            8951,
            4275,
            2846,
            4826,
            5387,
            2294,
            4684,
            2369,
            3550,
            6703,
            1139,
            1322,
            1469,
            4783,
            9186,
            501,
            947,
            3383,
            7240,
            1415,
            4835,
            747,
            531,
            5188,
            9709,
            4400,
            8306,
            7959,
            3348,
            2493,
            4025,
            8722,
            9167,
            1439,
            711,
            3106,
            9911,
            7079,
            8607,
            7233,
            1851,
            6161,
            2188,
            5777,
            3612,
            6502,
            8259,
            4878,
            5679,
            9922,
            591,
            3606,
            5363,
            5824,
            5169,
            9833,
            4481,
            9140,
            6820,
            3619,
            6067,
            9421,
            9932,
            5134,
            7634,
            9305,
            7871,
            511,
            5073,
            8015,
            6812,
            3580,
            541,
            2446,
            3937,
            3535,
            1121,
            643,
            1904,
            7099,
            9710,
            5162,
            9549,
            6181,
            3368,
            7653,
            7296,
            9383,
            4243,
            6362,
            4723,
            3638,
            6610,
            1892,
            7076,
            9549,
            6917,
            705,
            1931,
            7598,
            7706,
            6469,
            7367,
            4619,
            8113,
            6144,
            9128,
            9401,
            7317,
            5066,
            2588,
            7406,
            2699,
            9700,
            455,
            5908,
            1336,
            5283,
            120,
            554,
            3576,
            9943,
            9809,
            8760,
            5566,
            9055,
            1157,
            2315,
            1956,
            8066,
            9489,
            8779,
            2172,
            9398,
            3762,
            8945,
            1925,
            7707,
            1481,
            8064,
            4755,
            2558,
            2622,
            7440,
            7781,
            9149,
            1209,
            5410,
            1117,
            8296,
            9548,
            585,
            3038,
            4286,
            2153,
            742,
            1042,
            7788,
            6587,
            6858,
            1311,
            5486,
            3896,
            9350,
            3133,
            6643,
            3337,
            9848,
            4595,
            5218,
            3422,
            8473,
            9194,
            8759,
            5318,
            2153,
            1707,
            9659,
            602,
            8697,
            3889,
            6183,
            291,
            8879,
            4074,
            2933,
            6958,
            6825,
            7167,
            4491,
            8349,
            5738,
            1231,
            6635,
            1454,
            8959,
            9725,
            7137,
            6258,
            275,
            6092,
            4824,
            4649,
            8900,
            8212,
            3254,
            4107,
            8513,
            7773,
            297,
            4350,
            4877,
            3682,
            997,
            9830,
            3340,
            3506,
            6633,
            5607,
            1107,
            1404,
            2178,
            9681,
            3227,
            3693,
            8602,
            1968,
            3898,
            3480,
            7607,
            1476,
            845,
            9310,
            2210,
            3887,
            8348,
            2921,
            5845,
            5199,
            9084,
            661,
            2698,
            722,
            4060,
            5611,
            9443,
            5260,
            510,
            5263,
            9845,
            227,
            5094,
            9967,
            6666,
            4997,
            7266,
            7096,
            208,
            4501,
            1951,
            9127,
            5010,
            7854,
            3498,
            1373,
            9995,
            2330,
            9770,
            8429,
            9427,
            5215,
            8478,
            2962,
            1382,
            7440,
            8260,
            4832,
            2284,
            4714,
            1205,
            6938,
            46,
            5557,
            4459,
            8728,
            8354,
            8362,
            7086,
            3003,
            858,
            5303,
            6952,
            3785,
            4993,
            4760,
            4150,
            94,
            4679,
            3695,
            8053,
            8220,
            9398,
            9287,
            4301,
            2041,
            3599,
            9973,
            6009,
            6689,
            3799,
            9300,
            3090,
            2039,
            5780,
            1617,
            4622,
            7075,
            9849,
            3998,
            5095,
            1661,
            1769,
            72,
            3550,
            3277,
            1517,
            7739,
            1571,
            9828,
            5531,
            933,
            1472,
            9016,
            6741,
            4763,
            5576,
            3754,
            6893,
            7173,
            4800,
            4058,
            2705,
            3413,
            9224,
            53,
            7769,
            4367,
            1417,
            9647,
            3835,
            9058,
            5091,
            68,
            4573,
            7834,
            6686,
            3593,
            1296,
            7548,
            215,
            6176,
            7517,
            9926,
            2319,
            4923,
            6435,
            9131,
            6225,
            6420,
            9197,
            1826,
            2488,
            4387,
            8628,
            4553,
            9749,
            6573,
            8655,
            5353,
            9496,
            6491,
            6668,
            1231,
            1439,
            4712,
            7287,
            7352,
            5418,
            5673,
            4251,
            5557,
            2461,
            5516,
            1707,
            6186,
            2723,
            5604,
            7292,
            2791,
            5794,
            2055,
            3828,
            6046,
            8681,
            6386,
            7908,
            8760,
            556,
            6635,
            4,
            1095,
            6595,
            8083,
            1993,
            5568,
            2074,
            5502,
            8748,
            7628,
            2545,
            2690,
            529,
            7843,
            3227,
            7779,
            7238,
            4599,
            3149,
            1518,
            5001,
            2053,
            2225,
            9238,
            668,
            1826,
            1616,
            9974,
            449,
            9966,
            9800,
            6122,
            3904,
            2929,
            1201,
            2238,
            6268,
            609,
            601,
            3378,
            2648,
            5862,
            8104,
            9496,
            5153,
            6314,
            2926,
            2402,
            2619,
            2810,
            2429,
            942,
            2216,
            9950,
            9136,
            3316,
            5536,
            2841,
            6956,
            5859,
            369,
            5671,
            5628,
            8510,
            2,
            3268,
            599,
            8214,
            4522,
            289,
            5746,
            1003,
            1481,
            2377,
            4540,
            3040,
            4996,
            9267,
            5556,
            7117,
            6632,
            5305,
            6856,
            7913,
            3822,
            9940,
            1549,
            5009,
            1438,
            5652,
            1689,
            9380,
            3254,
            71,
            4753,
            2045,
            2972,
            8669,
            7043,
            6683,
            7499,
            8546,
            1659,
            6771,
            5346,
            2016,
            5704,
            3819,
            7906,
            4887,
            6974,
            4379,
            8019,
            3755,
            2390,
            3268,
            5164,
            8138,
            9751,
            816,
            472,
            660,
            3101,
            9770,
            9634,
            761,
            5452,
            6198,
            7139,
            8266,
            5045,
            6236,
            9348,
            8225,
            3687,
            8692,
            4647,
            7613,
            6166,
            3145,
            7115,
            2608,
            9083,
            8070,
            8067,
            1589,
            2331,
            7144,
            7190,
            3955,
            1539,
            5657,
            7988,
            4049,
            2156,
            2228,
            9506,
            6314,
            7094,
            3776,
            9192,
            2952,
            4484,
            2865,
            7480,
            6864,
            3194,
            7428,
            2063,
            5078,
            884,
            6767,
            4837,
            3478,
            1311,
            507,
            1330,
            6375,
            5040,
            2936,
            4778,
            4344,
            4098,
            8075,
            7920,
            1276,
            5721,
            3437,
            974,
            8637,
            4927,
            3257,
            8875,
            5530,
            5161,
            4818,
            4020,
            1860,
            3067,
            565,
            1195,
            798,
            5342,
            9389,
            7180,
            2607,
            4026,
            6214,
            7861,
            5033,
            9135,
            5060,
            5005,
            6197,
            8776,
            3725,
            2868,
            7082,
            2469,
            3787,
            2449,
            8339,
            6543,
            868,
            8766,
            7093,
            8036,
            574,
            5847,
            8317,
            9011,
            8274,
            9566,
            3983,
            3714,
            2332,
            1343,
            6609,
            4227,
            5739,
            8801,
            378,
            6449,
            7312,
            6192,
            3756,
            1739,
            1351,
            1750,
            1337,
            2061,
            4968,
            524,
            6372,
            9689,
            8094,
            9596,
            4747,
            5339,
            1551,
            1878,
            7637,
            5529,
            9314,
            6494,
            505,
            7012,
            9901,
            9840,
            2332,
            9939,
            790,
            108,
            5463,
            5009,
            246,
            6582,
            232,
            1973,
            9577,
            9798,
        ],
        626,
        10917,
    ),
]


class SplitArrayLargestSumTestCase(unittest.TestCase):
    @parameterized.expand(SPLIT_ARRAY_LARGEST_SUM_TEST_CASES)
    def test_split_array(self, nums: List[int], k: int, expected: int):
        actual = split_array(nums, k)
        self.assertEqual(expected, actual)

    @parameterized.expand(SPLIT_ARRAY_LARGEST_SUM_TEST_CASES)
    def test_split_array_2(self, nums: List[int], k: int, expected: int):
        actual = split_array_2(nums, k)
        self.assertEqual(expected, actual)


if __name__ == "__main__":
    unittest.main()
